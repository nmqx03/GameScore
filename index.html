<!DOCTYPE html>
<html lang="vi">
<head>
  <meta charset="UTF-8"/>
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no"/>
  <style>* { touch-action: manipulation; }</style>
  <title>T√≠nh ƒêi·ªÉm</title>
  <link rel="icon" type="image/x-icon" href="images/logo.ico"/>
  <link rel="apple-touch-icon" href="images/logo.png"/>
  <link rel="stylesheet" href="style.css"/>
</head>
<body>

<!-- ‚ïê‚ïê BOARD PICKER ‚ïê‚ïê -->
<div id="board-picker-screen" class="full-screen hidden">
  <div class="bp-header">
    <div class="bp-logo">
      <img src="images/logo.png" alt="logo" onerror="this.style.display='none';this.nextElementSibling.style.display=''"/>
      <span style="display:none;font-size:42px">üÉè</span>
    </div>
    <h1 class="bp-title">T√≠nh ƒêi·ªÉm</h1>
    <p class="bp-sub">Ch·ªçn b·∫£ng ƒë·∫•u ho·∫∑c t·∫°o m·ªõi</p>
  </div>
  <div id="board-list" class="board-list"></div>
  <div id="bp-max-notice" class="bp-max-notice" style="display:none">
    ƒê√£ ƒë·∫°t t·ªëi ƒëa 5 b·∫£ng ƒë·∫•u. X√≥a b·∫£ng c≈© ƒë·ªÉ t·∫°o m·ªõi.
  </div>
  <button id="btn-create-board" class="bp-create-btn">
    <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2.5"><line x1="12" y1="5" x2="12" y2="19"/><line x1="5" y1="12" x2="19" y2="12"/></svg>
    T·∫°o b·∫£ng ƒë·∫•u m·ªõi
  </button>
</div>

<!-- ‚ïê‚ïê MAIN ‚ïê‚ïê -->
<div id="app" class="hidden">
  <header>
    <div class="header-left">
      <button id="btn-back-boards" class="icon-btn" title="V·ªÅ danh s√°ch">
        <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2.2"><polyline points="15 18 9 12 15 6"/></svg>
      </button>
    </div>
    <div class="header-center">
      <h1 id="board-title-display">B·∫£ng ƒë·∫•u</h1>
    </div>
    <div class="header-right">
      <button id="btn-new-board-from-game" class="icon-btn" title="T·∫°o b·∫£ng m·ªõi">
        <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2.2"><rect x="3" y="3" width="7" height="7" rx="1"/><rect x="14" y="3" width="7" height="7" rx="1"/><rect x="3" y="14" width="7" height="7" rx="1"/><path d="M17 17h4M19 15v4"/></svg>
      </button>
      <button id="btn-history" class="icon-btn">
        <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2.2"><circle cx="12" cy="12" r="10"/><polyline points="12 6 12 12 16 14"/></svg>
      </button>
      <button id="btn-reset" class="icon-btn danger">
        <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2.2"><polyline points="3 6 5 6 21 6"/><path d="M19 6l-1 14H6L5 6"/><path d="M10 11v6M14 11v6"/><path d="M9 6V4h6v2"/></svg>
      </button>
    </div>
  </header>

  <!-- S√¢m scoreboard -->
  <div id="sb-container" class="hidden"></div>

  <!-- Poker scoreboard -->
  <div id="poker-container" class="hidden"></div>

  <button id="btn-new-round" class="fab">
    <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2.5"><line x1="12" y1="5" x2="12" y2="19"/><line x1="5" y1="12" x2="19" y2="12"/></svg>
    V√°n m·ªõi
  </button>

  <!-- Poker FAB: k·∫øt th√∫c / rebuy -->
  <div id="poker-fabs" class="poker-fabs hidden">
    <button id="btn-poker-rebuy" class="fab fab-secondary">
      <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2.5"><circle cx="12" cy="12" r="9"/><path d="M12 8v4l3 3"/></svg>
      Rebuy
    </button>
    <button id="btn-poker-end" class="fab">
      <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2.5"><polyline points="20 6 9 17 4 12"/></svg>
      K·∫øt th√∫c
    </button>
  </div>
</div>

<!-- ‚ïê‚ïê BOARD MODAL (t·∫°o b·∫£ng) ‚ïê‚ïê -->
<div id="board-modal" class="modal-overlay center-modal">
  <div class="modal-box board-setup-box">
    <div class="modal-header">
      <h2>T·∫°o b·∫£ng ƒë·∫•u m·ªõi</h2>
      <button class="close-btn" id="btn-close-board-modal">‚úï</button>
    </div>

    <!-- Game type selector -->
    <div class="game-type-bar">
      <button class="game-type-btn active" data-type="sam">üÉè S√¢m</button>
      <button class="game-type-btn" data-type="poker">‚ô†Ô∏è Poker</button>
    </div>

    <div class="board-name-row" style="margin-top:12px">
      <label class="field-label">T√™n b·∫£ng ƒë·∫•u</label>
      <input type="text" id="board-name-input" class="name-edit-input" placeholder="VD: T·ªëi th·ª© 6, Nh√≥m A‚Ä¶" maxlength="30"/>
    </div>

    <!-- Poker settings (·∫©n khi ch·ªçn S√¢m) -->
    <div id="poker-settings" class="poker-settings hidden">
      <div class="poker-settings-row">
        <label class="field-label">Chip ban ƒë·∫ßu / ng∆∞·ªùi</label>
        <input type="number" id="poker-buyin-chips" class="name-edit-input" placeholder="VD: 100" min="1" value="100"/>
      </div>
      <div class="poker-settings-row">
        <label class="field-label">1 chip = (VNƒê)</label>
        <input type="number" id="poker-chip-value" class="name-edit-input" placeholder="VD: 1000" min="0" value="1000"/>
      </div>
    </div>

    <div style="margin-top:14px">
      <label class="field-label" style="margin-bottom:8px;display:block">Ng∆∞·ªùi ch∆°i</label>
      <div id="setup-players"></div>
      <button id="btn-add-player" class="btn-add-player">+ Th√™m ng∆∞·ªùi ch∆°i</button>
    </div>
    <div class="modal-footer">
      <button id="btn-cancel-board" class="btn-outline">H·ªßy</button>
      <button id="btn-save-board" class="btn-primary">B·∫Øt ƒë·∫ßu</button>
    </div>
  </div>
</div>

<!-- legacy -->
<div id="setup-screen" style="display:none!important"></div>

<!-- ‚ïê‚ïê ROUND MODAL (S√¢m) ‚ïê‚ïê -->
<div id="round-modal" class="modal-overlay">
  <div class="modal-box round-box">
    <div class="modal-header">
      <h2 id="round-modal-title">V√°n m·ªõi</h2>
      <button class="close-btn" id="btn-close-modal">‚úï</button>
    </div>
    <div id="entry-panel">
      <div class="tab-bar">
        <button class="tab active" data-tab="manual">Th·ªß c√¥ng</button>
        <button class="tab" data-tab="winner">Nh·∫•t ƒÉn t·∫•t</button>
      </div>
      <div id="tab-manual" class="tab-content active">
        <div id="manual-inputs"></div>
        <div class="total-row">
          <span>T·ªïng: <strong id="manual-total">0</strong></span>
          <span id="manual-hint" class="hint">(Ph·∫£i b·∫±ng 0)</span>
        </div>
      </div>
      <div id="tab-winner" class="tab-content">
        <div id="winner-inputs"></div>
        <div class="total-row">
          <span>Ng∆∞·ªùi nh·∫•t nh·∫≠n: <strong id="winner-total">0</strong></span>
        </div>
      </div>
    </div>
    <div id="inline-numpad" class="inline-numpad hidden">
      <div class="inp-bar">
        <div class="inp-who">
          <span id="inp-dot" class="inp-dot"></span>
          <span id="inp-name" class="inp-name"></span>
        </div>
        <button id="btn-np-close" class="close-btn">‚úï</button>
      </div>
      <div id="np-display" class="np-display is-zero">0</div>
      <div class="np-grid">
        <button class="nk" data-val="7">7</button>
        <button class="nk" data-val="8">8</button>
        <button class="nk" data-val="9">9</button>
        <button class="nk nk-fn" data-action="backspace">‚å´</button>
        <button class="nk" data-val="4">4</button>
        <button class="nk" data-val="5">5</button>
        <button class="nk" data-val="6">6</button>
        <button class="nk nk-fn" data-action="clear">C</button>
        <button class="nk" data-val="1">1</button>
        <button class="nk" data-val="2">2</button>
        <button class="nk" data-val="3">3</button>
        <button class="nk nk-ok" data-action="confirm">OK</button>
        <button class="nk nk-minus" data-action="set-negative">‚àí</button>
        <button class="nk" data-val="0">0</button>
        <button class="nk nk-000" data-val="000">000</button>
        <button class="nk nk-plus" data-action="set-positive">+</button>
      </div>
    </div>
    <div id="round-footer" class="modal-footer">
      <button id="btn-clear-round" class="btn-outline">X√≥a</button>
      <button id="btn-save-round" class="btn-primary">L∆∞u v√°n</button>
    </div>
  </div>
</div>

<!-- ‚ïê‚ïê POKER END SESSION MODAL ‚ïê‚ïê -->
<div id="poker-end-modal" class="modal-overlay">
  <div class="modal-box round-box">
    <div class="modal-header">
      <h2>K·∫øt th√∫c session</h2>
      <button class="close-btn" id="btn-close-poker-end">‚úï</button>
    </div>
    <p class="poker-end-desc">Nh·∫≠p s·ªë chip cu·ªëi v√°n c·ªßa t·ª´ng ng∆∞·ªùi</p>
    <div id="poker-end-inputs"></div>
    <div id="poker-end-inline-numpad" class="inline-numpad hidden">
      <div class="inp-bar">
        <div class="inp-who">
          <span id="pk-inp-dot" class="inp-dot"></span>
          <span id="pk-inp-name" class="inp-name"></span>
        </div>
        <button id="btn-pk-np-close" class="close-btn">‚úï</button>
      </div>
      <div id="pk-np-display" class="np-display is-zero">0</div>
      <div class="np-grid" id="pk-np-grid">
        <button class="nk" data-val="7">7</button>
        <button class="nk" data-val="8">8</button>
        <button class="nk" data-val="9">9</button>
        <button class="nk nk-fn" data-action="backspace">‚å´</button>
        <button class="nk" data-val="4">4</button>
        <button class="nk" data-val="5">5</button>
        <button class="nk" data-val="6">6</button>
        <button class="nk nk-fn" data-action="clear">C</button>
        <button class="nk" data-val="1">1</button>
        <button class="nk" data-val="2">2</button>
        <button class="nk" data-val="3">3</button>
        <button class="nk nk-ok" data-action="confirm">OK</button>
        <button class="nk nk-minus" data-action="set-negative" style="visibility:hidden">‚àí</button>
        <button class="nk" data-val="0">0</button>
        <button class="nk nk-000" data-val="000">000</button>
        <button class="nk nk-plus" data-action="set-positive" style="visibility:hidden">+</button>
      </div>
    </div>
    <div class="modal-footer">
      <button id="btn-cancel-poker-end" class="btn-outline">H·ªßy</button>
      <button id="btn-save-poker-end" class="btn-primary">L∆∞u session</button>
    </div>
  </div>
</div>

<!-- ‚ïê‚ïê POKER REBUY MODAL ‚ïê‚ïê -->
<div id="poker-rebuy-modal" class="modal-overlay center-modal">
  <div class="modal-box confirm-box">
    <div class="modal-header">
      <h2>Rebuy</h2>
      <button class="close-btn" id="btn-close-rebuy">‚úï</button>
    </div>
    <div id="poker-rebuy-inputs"></div>
    <div class="modal-footer" style="margin-top:12px">
      <button id="btn-cancel-rebuy" class="btn-outline">H·ªßy</button>
      <button id="btn-save-rebuy" class="btn-primary">X√°c nh·∫≠n</button>
    </div>
  </div>
</div>

<!-- ‚ïê‚ïê EDIT NAME ‚ïê‚ïê -->
<div id="name-modal" class="modal-overlay center-modal">
  <div class="modal-box confirm-box">
    <div class="modal-header">
      <h2>S·ª≠a t√™n</h2>
      <button class="close-btn" id="btn-close-name">‚úï</button>
    </div>
    <input type="text" id="name-edit-input" class="name-edit-input" maxlength="16" placeholder="T√™n ng∆∞·ªùi ch∆°i"/>
    <div class="modal-footer" style="margin-top:14px">
      <button id="btn-cancel-name" class="btn-outline">H·ªßy</button>
      <button id="btn-save-name" class="btn-primary">L∆∞u</button>
    </div>
  </div>
</div>

<!-- ‚ïê‚ïê HISTORY ‚ïê‚ïê -->
<div id="history-modal" class="modal-overlay">
  <div class="modal-box">
    <div class="modal-header">
      <h2>L·ªãch s·ª≠</h2>
      <button class="close-btn" id="btn-close-history">‚úï</button>
    </div>
    <div id="history-list"></div>
  </div>
</div>

<!-- ‚ïê‚ïê COLOR PICKER ‚ïê‚ïê -->
<div id="color-modal" class="modal-overlay center-modal">
  <div class="modal-box color-box">
    <div class="modal-header">
      <h2>Ch·ªçn m√†u</h2>
      <button class="close-btn" id="btn-close-color">‚úï</button>
    </div>
    <div id="color-grid" class="color-grid"></div>
  </div>
</div>

<!-- ‚ïê‚ïê CONFIRM RESET ‚ïê‚ïê -->
<div id="confirm-modal" class="modal-overlay center-modal">
  <div class="modal-box confirm-box">
    <h2>X√≥a b·∫£ng ƒë·∫•u n√†y?</h2>
    <p>To√†n b·ªô ƒëi·ªÉm v√† l·ªãch s·ª≠ s·∫Ω b·ªã x√≥a vƒ©nh vi·ªÖn.</p>
    <div class="modal-footer">
      <button id="btn-cancel-reset" class="btn-outline">H·ªßy</button>
      <button id="btn-confirm-reset" class="btn-danger">X√≥a</button>
    </div>
  </div>
</div>

<!-- ‚ïê‚ïê CONFIRM DELETE BOARD ‚ïê‚ïê -->
<div id="confirm-delete-board-modal" class="modal-overlay center-modal">
  <div class="modal-box confirm-box">
    <h2>X√≥a b·∫£ng ƒë·∫•u?</h2>
    <p id="confirm-delete-board-text">B·∫£ng n√†y s·∫Ω b·ªã x√≥a vƒ©nh vi·ªÖn.</p>
    <div class="modal-footer">
      <button id="btn-cancel-delete-board" class="btn-outline">H·ªßy</button>
      <button id="btn-confirm-delete-board" class="btn-danger">X√≥a</button>
    </div>
  </div>
</div>

<script src="app.js"></script>
</body>
</html>